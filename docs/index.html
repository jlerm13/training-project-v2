<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IGNITION APG</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="css/styles.css?v=2.1.1">

    <!-- PWA Configuration -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#e00122">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="IGNITION APG">
    <link rel="apple-touch-icon" href="assets/icons/icon-192x192.png">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
</head>
    
<body>

    <div class="container">
        <div class="header">
            <h1>IGNITION APG</h1>
            <p>Your training. Your way.</p>
        </div>

        <!-- Welcome Screen -->
        <div id="welcomeScreen">
            <div class="card" style="text-align: center;">
                <h2>Build your workout in 2 minutes.</h2>
                <p style="color: var(--text-secondary); margin-bottom: 24px; font-size: 1.1rem;">
                    Choose your equipment. Set your goals. Train.
                </p>
                <button class="btn" onclick="startOnboarding()" style="width: 100%; padding: 16px; font-size: 1.1rem;">
                    Start Training
                </button>
            </div>
        </div>

        <!-- Progress Tracker -->
        <div id="progressTracker" class="hidden">
            <div class="progress-tracker">
                <div class="progress-step" id="step1"><div class="progress-circle">1</div><div class="progress-label">Autonomy</div></div>
                <div class="progress-step" id="step2"><div class="progress-circle">2</div><div class="progress-label">Phase</div></div>
                <div class="progress-step" id="step3"><div class="progress-circle">3</div><div class="progress-label">Equipment</div></div>
                <div class="progress-step" id="step4"><div class="progress-circle">4</div><div class="progress-label">Ready</div></div>
            </div>
        </div>

        <!-- Onboarding Screens -->
        <div id="experienceScreen" class="hidden"></div>
        <div id="phaseScreen" class="hidden"></div>
        <div id="equipmentScreen" class="hidden"></div>

        <!-- Confirmation Screen -->
        <div id="confirmationScreen" class="hidden">
            <div class="card" style="text-align: center; max-width: 600px; margin: 0 auto;">
                <div id="confirmationContent"></div>
            </div>
        </div>



        <!-- Program Screen -->
        <div id="programScreen" class="hidden">
            <div class="card">
                <!-- UPDATED HEADER: More action-oriented, info button added -->
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <h2 id="programTitle">Week 1</h2>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-secondary" onclick="toggleProgramInfo()" id="programInfoBtn" style="padding: 10px 16px; font-size: 0.9rem;">
                            ‚ÑπÔ∏è About This Phase
                        </button>
                        <button class="btn btn-secondary" onclick="resetApp()" style="padding: 10px 16px; font-size: 0.9rem;">Start Over</button>
                    </div>
                </div>

                <!-- CRITICAL CHANGE: Program Overview is now HIDDEN by default -->
                <!-- Athletes see this ONLY if they click "About This Phase" -->
                <div id="programOverview" class="info-box hidden" style="margin-bottom: 20px;"></div>

                <!-- Template Tabs - simplified header -->
                <div class="template-selector">
                    <div class="template-tabs"></div>
                </div>

                <!-- Week Navigation -->
                <div class="week-navigation">
                    <button class="week-nav-btn" onclick="previousWeek()" id="prevWeekBtn">‚Üê Previous</button>
                    <div id="weekDisplay">Week 1</div>
                    <button class="week-nav-btn" onclick="nextWeek()" id="nextWeekBtn">Next ‚Üí</button>
                </div>

                <!-- THE HERO: Workout Days shown IMMEDIATELY -->
                <div id="workoutDays"></div>

                <!-- Debug/Error Output -->
                <div id="errorBox" class="info-box hidden" style="color: red; margin-top: 16px;"></div>
            </div>
        </div>
        
    <!-- 
    =====================================================================
    SCRIPT LOADING ORDER v2.1.1 - REFACTORED ARCHITECTURE
    
    NEW STRUCTURE:
    1. Exercise system (loader + modules)
    2. Block periodization
    3. Template system (loader + modules)
    4. Workout tracking
    5. STATE MANAGER (new!)
    6. TEMPLATE HELPERS (new!)
    7. UI BUILDER (new!)
    8. WORKOUT RENDERER (new!)
    9. VIEW MANAGER (new!)
    10. APP.JS - orchestration only (new!)
    
    Cache busting: ?v=2.1.1
    =====================================================================
    -->
    
    <!-- 1. Exercise System -->
    <script src="js/exercises/exercise-loader.js?v=2.1.1"></script>
    <script src="js/exercises/whiteTemplateExercises.js?v=2.1.1"></script>
    <script>
        if (typeof initializeExercises === 'function') {
            initializeExercises();
        }
    </script>
    
    <!-- 2. Block Periodization -->
    <script src="js/blockPeriodization.js?v=2.1.1"></script>
    
    <!-- 3. Template System -->
    <script src="js/templates/template-loader.js?v=2.1.1"></script>
    <script src="js/templates/earlyOffSeason/white.js?v=2.1.1"></script>
    <script src="js/templates/earlyOffSeason/red.js?v=2.1.1"></script>
    <script src="js/templates/earlyOffSeason/blue.js?v=2.1.1"></script>
    <script src="js/templates/earlyOffSeason/gold.js?v=2.1.1"></script>
    <script>
        if (typeof initializeTemplates === 'function') {
            initializeTemplates();
        }
    </script>

    <!-- 4. Workout Tracking -->
    <script src="js/workout-tracker.js?v=2.1.1"></script>
    <script src="js/workout-tracker-ui.js?v=2.1.1"></script>

    <!-- 5. NEW MODULES (order matters!) -->
    <script src="js/state-manager.js?v=2.1.1"></script>
    <script src="js/template-helpers.js?v=2.1.1"></script>
    <script src="js/ui-builder.js?v=2.1.1"></script>
    <script src="js/workout-renderer.js?v=2.1.1"></script>
    <script src="js/view-manager.js?v=2.1.1"></script>
    
    <!-- 6. Main App - LAST -->
    <script src="js/app.js?v=2.1.1"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => console.log('‚úÖ Service Worker registered'))
                    .catch(error => console.log('‚ùå Service Worker registration failed:', error));
            });
        }
    </script>
    
    <script>
        console.log('üöÄ IGNITION APG v2.1.1 - Refactored Architecture');
    </script>
</body>
</html>
